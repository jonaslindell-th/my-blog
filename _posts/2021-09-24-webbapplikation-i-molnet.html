---
layout: post
title: "Webbapplikation i molnet"
date: 2021-09-24 16:01:10 +0200
categories: jekyll update
background: "/img/posts/06.jpg"
---

<h2 class="section-heading">
  Razor Page &#8594; ACR &#8594; Azure App Services
</h2>

<hr />
<br />

<h3>Inledning</h3>

<p>
  I det här blogginlägget kommer jag gå igenom hur jag utvecklade min Razor Page
  applikation som hanterar att hämta in dokument och skriva nya till min Cosmos
  Db som kör i molnet, skapar min docker image, pushar till Azure Container
  Registry och kör den i Azure App Service.
</p>

<h3>Min webbapplikation</h3>

<p>
  Min Razor Page applikation hanterar mina "att göra" dokument. Webbsidan kommer
  att ha två sidor för att hantera mina ToDo's, en för att läsa in alla dokument
  och skriva ut dom och en för att skapa upp nya genom ett formulär. För att
  åstadkomma detta så använder jag mig av mina två funktioner som körs i molnet
  som anropas med hjälp av RestSharp.
</p>
<span style="margin-left: -25%" class="caption text-muted"
  >Vill du veta mer om mina Azure Functions? Klicka på
  <a
    href="https://jonaslindell-th.github.io/my-blog/jekyll/update/2021/09/17/serverless-applications.html"
    >Länken</a
  ></span
>

<p>
  För att komma igång med ett nytt Razor Page projekt så skapade jag upp det
  genom Visual Studio's Template. Skapade en ny page "Todos" som ska visa upp
  alla mina att göra objekt och installerade NuGet paket för
  <a href="https://www.nuget.org/packages/RestSharp">RestSharp</a>.
</p>

<p>
  Nu behöver jag skapa upp en todo modell som matchar mina dokument i databasen
  och resultatet av min modell ser ut så här.
</p>

<img
  class="img-fluid"
  src="https://github.com/jonaslindell-th/my-blog/blob/main/img/posts/webapp/todomodell.png?raw=true"
  alt="Bild på min todomodell"
/>

<p>
  Med min modell färdig vill jag se till att jag kan hämta in allt från
  databasen med hjälp av restsharp så jag skriver min OnGet metod.
</p>

<img
  class="img-fluid"
  src="https://github.com/jonaslindell-th/my-blog/blob/main/img/posts/webapp/onget.png?raw=true"
  alt="Bild på min OnGet metod"
/>

<p>
  Skapar upp en todo lista som klassfält. Anger min baseurl och resurs som jag
  hämtat från min funktion i Azure Portal.
</p>

<p>
  Metoden är async och inväntar mitt anrop mot databasen innan den returnerar
  sidan, för att på så sätt ha min lista med todo objekt att iterera igenom i
  min Razor Page med en foreach loop.
</p>

<p>
  Efter att ha kontrollerat att jag nu har tillgång till alla mina todo objekt
  genom debuggern så kan jag börja slipa på hur min sida ska se ut.
</p>

<img
  class="img-fluid"
  src="https://github.com/jonaslindell-th/my-blog/blob/main/img/posts/webapp/todoshtml.png?raw=true"
  alt="Bild på min html/c#"
/>

<p>
  Använder en tabell för att visa upp innehållet, och har satt en overflow
  scrollbar om jag överskrider 500 pixlar för innehållet. Refererar till min
  till min lista med todo's med Model.TodoModels och itererar igenom den, med
  Html.DisplayFor kan jag skriva ut värden för varje property.
</p>

<p>Kör jag min applikation lokalt ser den nu ut så här.</p>

<img
  class="img-fluid"
  src="https://github.com/jonaslindell-th/my-blog/blob/main/img/posts/webapp/todopreview.png?raw=true"
  alt="Bild på min view todo's sida."
/>

<p>
  För att posta nya todo's till databasen så skapar jag upp en ny sida på
  liknande sätt. Använder ett väldigt simpelt formulär för att sköta detta.
</p>

<img
  class="img-fluid"
  src="https://github.com/jonaslindell-th/my-blog/blob/main/img/posts/webapp/nytodo.png?raw=true"
  alt="Bild på min view todo's sida."
/>

<p>
  name="title" och "description" refererar till mina properties som ligger i min
  PageModel, jag använder en OnPost metod för att skapa upp ett nytt ToDoModel
  objekt som jag lägger till i min request body.
</p>

<p>
  Just nu gör jag inget med svaret jag får tillbaka, men skulle jag dra det här
  längre kan jag använda svarets status för att printa ut på sidan om det
  lyckats att spara eller inte.
</p>
